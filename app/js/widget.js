function gotoPin(e){var n=$(".wrapper .pin");n.removeClass("current").eq(e).addClass("current")}(function(){var e=navigator.userAgent.toLowerCase(),n={isWx:function(){return!!/micromessenger/.test(e)},msgBox:function(e,n){n?$("body").append('<div class="ajaxpop msgbox minwidthbox"><div class="loading">'+e+"</div></div>"):$("body").append('<div class="ajaxpop msgbox"><div class="loading"><div class="icon-loading"></div>'+e+"</div></div>")},errorMsg:{add:function(e,n){e.find(".error").length?e.find(".error").html(n):e.append('<div class="error">'+n+"</div>")},remove:function(e){e.find(".error").length&&e.find(".error").remove()}}};this.Common=n}).call(this),function(){"use strict";var e=function(){this.curPage=0,this.selectedColor=""};e.prototype={init:function(){var e=this;$(".loading-wrap").addClass("show");var n="",t=[n+"/images/logo.png",n+"/images/bg-1.png",n+"/images/btn-get.png",n+"/images/btn-getkeycode.png",n+"/images/btn-open.png",n+"/images/btn-share.png",n+"/images/btn-submit2.png",n+"/images/c-2.png",n+"/images/c-bg2.png",n+"/images/c-txt.png",n+"/images/coupon-bg.png",n+"/images/coupon-logo.png",n+"/images/input-border.png",n+"/images/logo.png",n+"/images/min-30.png",n+"/images/money-list.png",n+"/images/p2-bg.png",n+"/images/p2-logo.png",n+"/images/p2-pop-text.png",n+"/images/p2-private.png",n+"/images/p2-search.png",n+"/images/p3-3.png",n+"/images/p3-bg.png",n+"/images/p3-logo.png",n+"/images/p3-pop-text.png",n+"/images/qrcode.png",n+"/images/redpacket-no.png",n+"/images/redpacket-yes.png",n+"/images/redpacket.png",n+"/images/share-overlay.png",n+"/images/t1.png",n+"/images/tips-text.png",n+"/images/tips.png"];new preLoader(t,{onProgress:function(){},onComplete:function(){$(".preloading").remove(1e3);$.ajax({type:"POST",url:"/api/status",dataType:"json",success:function(n){console.log(n),1==n.status?(212==n.msg?$(".p3-t1 .t2").addClass("money2"):188==n.msg&&$(".p3-t1 .t2").removeClass("money2"),gotoPin(2),e.toMoneyPage()):$(".tips-pop").removeClass("hide").addClass("fade animate")}});$(".btn-tips").on("click",function(e){$(this).hasClass("btn-tips-yes")?($(".tips-pop").addClass("hide"),gotoPin(0),_hmt.push(["_trackEvent","page","load","pv-1"])):window.location.reload()}),$(".btn-open").on("click",function(){gotoPin(1),_hmt.push(["_trackEvent","buttons","click","btn-open"]),_hmt.push(["_trackEvent","page","load","pv-2"]),e.formValidate()})}})},formValidate:function(){var e=this;$(".btn-getkeycode").on("click",function(n){if(n.preventDefault(),_hmt.push(["_trackEvent","buttons","click","sendmessage"]),!($(".countdown").length>0)&&e.formMobile()){console.log("validate phone number");var t=$(".input-phone").val();e.countDown();$.ajax({type:"POST",url:"/api/check",data:{mobile:t},dataType:"json",success:function(e){console.log(e),1==e.status?console.log("短信发送成功"):alert(e.msg)}})}});var n=!0;$(".pin-2 .btn-submit").on("click",function(){if(_hmt.push(["_trackEvent","buttons","click","Submit"]),e.formKeycode()){if(!n)return;n=!1;var t=$(".input-phone").val(),o=$(".input-keycode").val();console.log(t+"phonenumber"+o),Common.msgBox("loading...");$.ajax({type:"POST",url:"/api/submit",data:{mobile:t,code:o},dataType:"json",success:function(e){n=!0,$(".ajaxpop").remove(),1==e.status?(_hmt.push(["_trackEvent","buttons","click","PV-3"]),212==e.msg?$(".p3-t1 .t2").addClass("money2"):188==e.msg&&$(".p3-t1 .t2").removeClass("money2"),gotoPin(2)):6==e.status?(_hmt.push(["_trackEvent","buttons","click","PV-3"]),212==e.msg?$(".p3-t1 .t2").addClass("money2"):188==e.msg&&$(".p3-t1 .t2").removeClass("money2"),gotoPin(2)):2==e.status?(_hmt.push(["_trackEvent","buttons","click","PV-3"]),$(".pin-3").html(""),$(".qrcode-pop").removeClass("hide"),$(".qt-no").removeClass("hide"),$(".qt-yes").addClass("hide"),gotoPin(2)):alert(e.msg)}})}}),$(".privacy-term").on("click",function(){_hmt.push(["_trackEvent","buttons","click","Terms"]),$(".term-pop").removeClass("hide").addClass("animate fade")}),e.closePop(),e.toMoneyPage()},countDown:function(){var e=59,n=setInterval(function(){e--,$(".btn-getkeycode").addClass("countdown").html(e),0>=e&&(clearInterval(n),$(".btn-getkeycode").removeClass("countdown").html(""))},1e3)},closePop:function(){$(".btn-close").on("click",function(){$(this).parent().addClass("hide")})},toMoneyPage:function(){var e=this;e.closePop(),$(".btn-get").on("click",function(){_hmt.push(["_trackEvent","buttons","click","Redeem"]),_hmt.push(["_trackEvent","page","load","PV-4"]),$(".qrcode-pop").removeClass("hide").addClass("animate fade")}),$(".btn-share").on("click",function(){_hmt.push(["_trackEvent","buttons","click","Share"]),_hmt.push(["_trackEvent","page","load","PV-7"]),$(".share-pop").removeClass("hide").addClass("animate fade")})},formMobile:function(){var e=!0;if($(".input-phone").val()){var n=/^1\d{10}$/;n.test($(".input-phone").val())?Common.errorMsg.remove($(".input-phone").parent()):(e=!1,Common.errorMsg.add($(".input-phone").parent(),"手机号格式错误，请重新输入"))}else Common.errorMsg.add($(".input-phone").parent(),"手机号码不能为空"),e=!1;return!!e},formKeycode:function(){var e=!0;if($(".input-phone").val()){var n=/^1\d{10}$/;n.test($(".input-phone").val())?Common.errorMsg.remove($(".input-phone").parent()):(e=!1,Common.errorMsg.add($(".input-phone").parent(),"手机号格式错误，请重新输入"))}else Common.errorMsg.add($(".input-phone").parent(),"手机号码不能为空"),e=!1;return $(".input-keycode").val()?Common.errorMsg.remove($(".input-keycode").parent()):(Common.errorMsg.add($(".input-keycode").parent(),"验证码不能为空"),e=!1),!!e}},"function"==typeof define&&define.amd?define(function(){return e}):this.controller=e}.call(this),$(document).ready(function(e){var n=new controller;n.init()}),$(document).ready(function(){gotoPin(0),_hmt.push(["_trackEvent","page","load","PV-5"]),$(".weixin").on("click",function(){_hmt.push(["_trackEvent","buttons","click","WMALL"])}),$(".tmall").on("click",function(){_hmt.push(["_trackEvent","buttons","click","TMALL"]),_hmt.push(["_trackEvent","page","load","PV-6"]),gotoPin(1)}),$(".tao-code").on("touchstart touchend",function(e){this.setSelectionRange(0,$(this).text().length)})});var Form={phoneNum:function(){}};!function(e,n){var t=e.documentElement,o="orientationchange"in window?"orientationchange":"resize",a=function(){var e=t.clientWidth,n=window.innerHeight;e&&(e/n>750/1334?t.style.fontSize=50*(n/667)+"px":t.style.fontSize=50*(e/375)+"px")};e.addEventListener&&(n.addEventListener(o,a,!1),a())}(document,window),$(document).ready(function(){wx.ready(function(){wx.onMenuShareTimeline({title:"来自苏格兰的慷(xian)慨(jin)问(hong)候(bao)",link:"http://extra.chivas.com.cn",imgUrl:"http://7vzs67.com1.z0.glb.clouddn.com/2120e9e6-5424-41c6-bdc3-7d6db4b3e6b8?imageView2/1/w/200/h/200/format/jpg/q80/interlace/1",success:function(){_hmt.push(["_trackEvent","buttons","click","ShareToMoments"])},cancel:function(){}}),wx.onMenuShareAppMessage({title:"嘘寒问暖，不如现款",desc:"拆了这个芝华士红包，感受来自苏格兰的慷慨",link:"http://extra.chivas.com.cn",imgUrl:"http://7vzs67.com1.z0.glb.clouddn.com/21926ffe-1764-4fd1-82fd-5ddd151cf0e0?imageView2/1/w/200/h/200/format/jpg/q80/interlace/1",type:"",dataUrl:"",success:function(){_hmt.push(["_trackEvent","buttons","click","ShareToFriend"])},cancel:function(){}})})});
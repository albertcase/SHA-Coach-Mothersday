function gotoPin(n){var o=$(".wrapper .pin");o.removeClass("current").eq(n).addClass("current")}API={isFollow:function(n){$.ajax({url:"/api/status",type:"POST",dataType:"json",success:function(o){return n(o)}})},isLogin:function(n){$.ajax({url:"/api/islogin",type:"POST",dataType:"json",success:function(o){return n(o)}})},writeGreeting:function(n,o){$.ajax({url:"/api/greeting",type:"POST",dataType:"json",data:n,success:function(n){return o(n)}})},ballot:function(n,o){$.ajax({url:"/api/ballot",type:"POST",dataType:"json",data:n,success:function(n){return o(n)}})},sendVerifycode:function(n,o){$.ajax({url:"/api/sendverifycode",type:"POST",dataType:"json",data:n,success:function(n){return o(n)}})},customerBind:function(n,o){$.ajax({url:"/api/customerbind",type:"POST",dataType:"json",data:n,success:function(n){return o(n)}})},customerRegister:function(n,o){$.ajax({url:"/api/customerregister",type:"POST",dataType:"json",data:n,success:function(n){return o(n)}})},galleryList:function(n,o){$.ajax({url:"/api/list",type:"POST",dataType:"json",data:n,success:function(n){return o(n)}})}},function(){var n=navigator.userAgent.toLowerCase(),o={goHomepage:function(){gotoPin(0)},goWriteGreetingPage:function(){gotoPin(1)},goGallerypage:function(){window.location.href="gallery.html"},goMobilePage:function(){gotoPin(2)},goInfoPage:function(){gotoPin(3)},isWx:function(){return!!/micromessenger/.test(n)},msgBox:function(n,o){o?$("body").append('<div class="ajaxpop msgbox minwidthbox"><div class="loading">'+n+"</div></div>"):$("body").append('<div class="ajaxpop msgbox"><div class="loading"><div class="icon-loading"></div>'+n+"</div></div>")},errorMsg:{add:function(n,o){n.find(".error").length?n.find(".error").html(o):n.append('<div class="error">'+o+"</div>")},remove:function(n){n.find(".error").length&&n.find(".error").remove()}}};this.Common=o}.call(this),function(){"use strict";var n=function(){this.curPage=0,this.selectedColor=""};n.prototype={init:function(){var n=this;$(".loading-wrap").addClass("show");var o="/app",e=[o+"/images/logo.png"];new preLoader(e,{onProgress:function(){},onComplete:function(){$(".preloading").remove(1e3),Common.goWriteGreetingPage(),$(".btn-gogallery").on("click",function(n){Common.goGallerypage()}),$(".btn-filltext").on("click",function(){n.radomGreetingBg()}),$(".pin-2 .btn-submit").on("click",function(){n.generateGreeting()}),$(".pin-2 .btn-back").on("click",function(){Common.goHomepage()}),n.SubmitKeycodeForm(),n.radomGreetingBg(),n.SubmitInformationForm();var o=$(".form-info .radio-inline");o.on("click",function(){o.removeClass("actived"),$(this).addClass("actived")})}})},radomGreetingBg:function(){var n=Math.round(4*Math.random()+1);$(".photo-frame").attr("class","photo-frame photo photo-"+n)},generateGreeting:function(){Common.msgBox("loading..."),$(".share-pop").removeClass("hide")},MobileValidate:function(){var n=!0,o=$(".form-validate .input-phone");if(o.val()){var e=/^1\d{10}$/;e.test(o.val())?Common.errorMsg.remove(o.parent()):(n=!1,Common.errorMsg.add(o.parent(),"手机号格式错误，请重新输入"))}else Common.errorMsg.add(o.parent(),"手机号码不能为空"),n=!1;return!!n},FormKeycodeValidate:function(){var n=!0,o=$(".form-validate .input-phone"),e=$(".form-validate .input-keycode");if(o.val()){var t=/^1\d{10}$/;t.test(o.val())?Common.errorMsg.remove(o.parent()):(n=!1,Common.errorMsg.add(o.parent(),"手机号格式错误，请重新输入"))}else Common.errorMsg.add(o.parent(),"手机号码不能为空"),n=!1;return e.val()?Common.errorMsg.remove(e.parent()):(Common.errorMsg.add(e.parent(),"验证码不能为空"),n=!1),!!n},FormInforValidate:function(){var n=!0,o=$(".form-info .input-surname"),e=$(".form-info .input-name"),t=($("input[type='radio'][name='gender']:checked"),$(".form-info .input-mobile"),$(".form-info .input-email-pre")),a=$(".form-info .input-email-after");return o.val()?Common.errorMsg.remove(o.parent()):(Common.errorMsg.add(o.parent(),"姓不能为空"),n=!1),e.val()?Common.errorMsg.remove(e.parent()):(Common.errorMsg.add(e.parent(),"名不能为空"),n=!1),t.val()&&a.val()?Common.errorMsg.remove(t.parent()):(Common.errorMsg.add(t.parent(),"邮箱不能为空"),n=!1),!!n},SubmitKeycodeForm:function(){var n=this;$(".btn-getkeycode").on("click",function(o){if(o.preventDefault(),!($(".countdown").length>0)&&n.MobileValidate()){console.log("validate phone number");var e=$(".input-phone").val();n.countDown();$.ajax({type:"POST",url:"/api/check",data:{mobile:e},dataType:"json",success:function(n){console.log(n),1==n.status?console.log("短信发送成功"):alert(n.msg)}})}});var o=!0;$(".form-validate .form-btn-submit").on("click",function(){if(n.FormKeycodeValidate()){if(!o)return;o=!1;var e=$(".input-phone").val(),t=$(".input-keycode").val();console.log(e+"phonenumber"+t),Common.msgBox("loading...");$.ajax({type:"POST",url:"/api/submit",data:{mobile:e,code:t},dataType:"json",success:function(n){o=!0,$(".ajaxpop").remove(),console.log("do something...")}})}}),$(".privacy-term").on("click",function(){$(".term-pop").removeClass("hide").addClass("animate fade")}),n.closePop(),n.toMoneyPage()},SubmitInformationForm:function(){var n=this;$(".form-info .form-btn-submit").on("click",function(){n.FormInforValidate()&&console.log("validate success")})},countDown:function(){var n=59,o=setInterval(function(){n--,$(".btn-getkeycode").addClass("countdown").html(n),0>=n&&(clearInterval(o),$(".btn-getkeycode").removeClass("countdown").html(""))},1e3)},closePop:function(){$(".btn-close").on("click",function(){$(this).parent().addClass("hide")})},toMoneyPage:function(){var n=this;n.closePop(),$(".btn-get").on("click",function(){$(".qrcode-pop").removeClass("hide").addClass("animate fade")}),$(".btn-share").on("click",function(){$(".share-pop").removeClass("hide").addClass("animate fade")})}},"function"==typeof define&&define.amd?define(function(){return n}):this.controller=n}.call(this),$(document).ready(function(n){var o=new controller;o.init()}),$(document).ready(function(){gotoPin(0),_hmt.push(["_trackEvent","page","load","PV-5"]),$(".weixin").on("click",function(){_hmt.push(["_trackEvent","buttons","click","WMALL"])}),$(".tmall").on("click",function(){_hmt.push(["_trackEvent","buttons","click","TMALL"]),_hmt.push(["_trackEvent","page","load","PV-6"]),gotoPin(1)}),$(".tao-code").on("touchstart touchend",function(n){this.setSelectionRange(0,$(this).text().length)})});var Form={phoneNum:function(){}};!function(n,o){var e=n.documentElement,t="orientationchange"in window?"orientationchange":"resize",a=function(){var n=e.clientWidth,o=window.innerHeight;n&&(n/o>750/1334?e.style.fontSize=50*(o/667)+"px":e.style.fontSize=50*(n/375)+"px")};n.addEventListener&&(o.addEventListener(t,a,!1),a())}(document,window),$(document).ready(function(){wx.ready(function(){wx.onMenuShareTimeline({title:"来自苏格兰的慷(xian)慨(jin)问(hong)候(bao)",link:"http://extra.chivas.com.cn",imgUrl:"http://7vzs67.com1.z0.glb.clouddn.com/2120e9e6-5424-41c6-bdc3-7d6db4b3e6b8?imageView2/1/w/200/h/200/format/jpg/q80/interlace/1",success:function(){_hmt.push(["_trackEvent","buttons","click","ShareToMoments"])},cancel:function(){}}),wx.onMenuShareAppMessage({title:"嘘寒问暖，不如现款",desc:"拆了这个芝华士红包，感受来自苏格兰的慷慨",link:"http://extra.chivas.com.cn",imgUrl:"http://7vzs67.com1.z0.glb.clouddn.com/21926ffe-1764-4fd1-82fd-5ddd151cf0e0?imageView2/1/w/200/h/200/format/jpg/q80/interlace/1",type:"",dataUrl:"",success:function(){_hmt.push(["_trackEvent","buttons","click","ShareToFriend"])},cancel:function(){}})})});